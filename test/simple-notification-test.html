<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Notification Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-8">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">üîî Simple Notification Test</h1>

            <!-- Permission Status -->
            <div id="permissionStatus" class="mb-6 p-4 rounded-lg"></div>

            <!-- Action Buttons -->
            <div class="space-y-4">
                <button onclick="checkPermission()"
                    class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold">
                    1Ô∏è‚É£ Check Permission Status
                </button>

                <button onclick="requestPermission()"
                    class="w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 font-semibold">
                    2Ô∏è‚É£ Request Permission
                </button>

                <button onclick="sendTestNotification()"
                    class="w-full bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 font-semibold">
                    3Ô∏è‚É£ Send Test Notification
                </button>
            </div>

            <!-- Log Output -->
            <div id="log" class="mt-6 space-y-2"></div>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const colors = {
                info: 'bg-blue-100 text-blue-800 border-blue-300',
                success: 'bg-green-100 text-green-800 border-green-300',
                error: 'bg-red-100 text-red-800 border-red-300',
                warning: 'bg-yellow-100 text-yellow-800 border-yellow-300'
            };

            const entry = document.createElement('div');
            entry.className = `p-3 rounded border ${colors[type]}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.insertBefore(entry, logDiv.firstChild);
        }

        function checkPermission() {
            const permission = Notification.permission;
            const statusDiv = document.getElementById('permissionStatus');

            log(`Current permission: ${permission}`, 'info');

            if (permission === 'granted') {
                statusDiv.innerHTML = `
                    <div class="bg-green-100 border border-green-400 text-green-700 rounded-lg p-4">
                        <p class="font-bold">‚úÖ Permission: GRANTED</p>
                        <p class="text-sm mt-1">You can receive notifications!</p>
                    </div>
                `;
            } else if (permission === 'denied') {
                statusDiv.innerHTML = `
                    <div class="bg-red-100 border border-red-400 text-red-700 rounded-lg p-4">
                        <p class="font-bold">‚ùå Permission: DENIED</p>
                        <p class="text-sm mt-2"><strong>How to fix:</strong></p>
                        <ol class="text-sm mt-1 ml-4 list-decimal">
                            <li>Click the lock icon üîí in the address bar</li>
                            <li>Find "Notifications" and change to "Allow"</li>
                            <li>Refresh this page</li>
                        </ol>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = `
                    <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg p-4">
                        <p class="font-bold">‚ö†Ô∏è Permission: DEFAULT (Not set)</p>
                        <p class="text-sm mt-1">Click "Request Permission" button below</p>
                    </div>
                `;
            }
        }

        async function requestPermission() {
            try {
                log('Requesting notification permission...', 'info');
                const permission = await Notification.requestPermission();

                if (permission === 'granted') {
                    log('‚úÖ Permission granted!', 'success');
                    checkPermission();
                } else if (permission === 'denied') {
                    log('‚ùå Permission denied', 'error');
                    checkPermission();
                } else {
                    log('‚ö†Ô∏è Permission dismissed', 'warning');
                }
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }

        function sendTestNotification() {
            if (Notification.permission !== 'granted') {
                log('‚ùå Cannot send notification - permission not granted', 'error');
                alert('Please grant notification permission first!');
                return;
            }

            try {
                log('Sending test notification...', 'info');

                const notification = new Notification('üéâ Test Successful!', {
                    body: 'Your notifications are working perfectly!',
                    icon: '/vite.svg',
                    badge: '/vite.svg',
                    tag: 'test-notification',
                    requireInteraction: false
                });

                notification.onclick = function () {
                    log('‚úÖ Notification clicked!', 'success');
                    window.focus();
                    notification.close();
                };

                log('‚úÖ Notification sent successfully!', 'success');
            } catch (error) {
                log(`‚ùå Error sending notification: ${error.message}`, 'error');
            }
        }

        // Check permission on page load
        window.addEventListener('load', () => {
            log('Page loaded - checking browser support...', 'info');

            if (!('Notification' in window)) {
                log('‚ùå This browser does not support notifications', 'error');
            } else {
                log('‚úÖ Browser supports notifications', 'success');
                checkPermission();
            }
        });
    </script>
</body>

</html>